diff --git a/sympy/ntheory/qs.py b/sympy/ntheory/qs.py
--- a/sympy/ntheory/qs.py
+++ b/sympy/ntheory/qs.py
@@ -108,17 +108,17 @@
     randint : A callable that takes two integers (a, b) and returns a random integer
               n such that a <= n <= b, similar to `random.randint`.
     """
+    approx_val = log(2*N)/2 - log(M)
     # `a` is a parameter of the sieve polynomial and `q` is the prime factors of `a`
     # randomly search for a combination of primes whose multiplication is close to approx_val
     # This multiplication of primes will be `a` and the primes will be `q`
     # `best_a` denotes that `a` is close to approx_val in the random search of combination
     best_a, best_q, best_ratio = None, None, None
-    start = 0 if idx_1000 is None else idx_1000
-    end = len(factor_base) - 1 if idx_5000 is None else idx_5000
+    start = idx_1000 or 0
+    end = idx_5000 or (len(factor_base) - 1)
     for _ in range(50):
         a = 1
         q = []
-        while(a < approx_val):
             rand_p = 0
             while(rand_p == 0 or rand_p in q):
                 rand_p = randint(start, end)


